# managed by puppet, contents will be replaced
<% type_map = scope['openssh::type_to_type'] -%>
<% @keys.sort_by { |title,keydata| title }.each do |title,keydata| -%>
<% if ! keydata.has_key?('ensure') or keydata['ensure'] != 'absent' and scope['openssh::supported_key_types'].include?(type_map[keydata['type']]) -%>
<% if keydata.has_key?('marker') -%>
<%= "@" + keydata['marker'] + " " -%>
<% end -%>
<% if keydata.has_key?('host_aliases') -%>
<%= title %>,<%= keydata['host_aliases'].join(',') + " " -%>
<% else -%>
<%= "#{title} " %>
<% end -%>
<%= keydata['type'] + " " -%>
<%= keydata['key'] + " " %>
<% end -%>
<% end -%>
