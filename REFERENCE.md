# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`openssh`](#openssh): install and configure openssh
* [`openssh::authorized_keys`](#opensshauthorized_keys): calls create_rsources on the ssh_authorized_keys hash
* [`openssh::config`](#opensshconfig): configure openssh, install ssh keys, etc.
* [`openssh::install`](#opensshinstall): install packages as needed
* [`openssh::known_hosts`](#opensshknown_hosts): manage hashed known hosts file
* [`openssh::service`](#opensshservice): control the openssh service
* [`openssh::ssh_config`](#opensshssh_config): create ssh_config resources

### Defined types

* [`openssh::keypair`](#opensshkeypair): installs ssh host key pairs

## Classes

### `openssh`

Install openssh server and client packages, optionally configure the
server and client, and start the service.
Module will optionally manage the following:
* ssh_known_hosts
* authorized_keys
* host key pairs
* signed ssh host certs (ie: /etc/ssh/ssh_host_ecdsa-cert.pub)

#### Examples

##### 

```puppet
include openssh
```

##### README

```puppet
see the README for more complete examples
```

#### Parameters

The following parameters are available in the `openssh` class.

##### `ssh_config`

Data type: `Hash`

ssh_config resources from augeasproviders_ssh (merged using hash deep)

##### `sshd_config`

Data type: `Hash`

sshd_config resources from augeasproviders_ssh (merged using hash deep)

##### `ssh_etc`

Data type: `Stdlib::Absolutepath`

where to put ssh configuration files, including the known hosts and ssh key pairs

Default value: `'/etc/ssh'`

##### `sshd_config_path`

Data type: `Optional[Stdlib::Absolutepath]`

full path to the sshd_config file, if undefined let the augeas provider decide

##### `ssh_config_path`

Data type: `Optional[Stdlib::Absolutepath]`

full path to the ssh_config file, if undefined let the augeas provider decide

##### `manage_known_hosts`

Data type: `Boolean`

manage the known hosts file, or not

Default value: ``false``

##### `known_hosts_path`

Data type: `Stdlib::Absolutepath`

full path to the known hosts files

##### `banner_path`

Data type: `Stdlib::Absolutepath`

path to banner file

##### `banner`

Data type: `Optional[String]`

string to put into the banner path, will not create the banner if this is left undefined

##### `private_key_mode`

Data type: `Stdlib::Filemode`

the mode to use on private keys

##### `private_key_owner`

Data type: `Variant[String,Integer]`

probably root, some systems use odd owner/groups on private keys

##### `private_key_group`

Data type: `Variant[String,Integer]`

probably root, some systems use odd owner/groups on private keys

##### `rsa_private_key`

Data type: `Variant[String,Undef]`

rsa private key

Default value: ``undef``

##### `rsa_public_key`

Data type: `Variant[String,Undef]`

rsa public key

Default value: ``undef``

##### `rsa_public_cert`

Data type: `Variant[String,Undef]`

rsa public cert (signed public key)

Default value: ``undef``

##### `dsa_private_key`

Data type: `Variant[String,Undef]`

dsa private key

Default value: ``undef``

##### `dsa_public_key`

Data type: `Variant[String,Undef]`

dsa public key

Default value: ``undef``

##### `dsa_public_cert`

Data type: `Variant[String,Undef]`

dsa public cert (signed public key)

Default value: ``undef``

##### `ecdsa_private_key`

Data type: `Variant[String,Undef]`

ecdsa private key

Default value: ``undef``

##### `ecdsa_public_key`

Data type: `Variant[String,Undef]`

ecdsa public key

Default value: ``undef``

##### `ecdsa_public_cert`

Data type: `Variant[String,Undef]`

ecdsa public cert (signed public key)

Default value: ``undef``

##### `ed25519_private_key`

Data type: `Variant[String,Undef]`

legacy host key management

Default value: ``undef``

##### `ed25519_public_key`

Data type: `Variant[String,Undef]`

ed25519 public key

Default value: ``undef``

##### `ed25519_public_cert`

Data type: `Variant[String,Undef]`

ed25519 public cert (signed public key)

Default value: ``undef``

##### `ssh_authorized_keys`

Data type: `Hash`

hash of ssh_authorized_key resources to create

##### `sshkeys`

Data type: `Hash[String,Struct[{
    'host_aliases' => Optional[Array[String]],
    'type'         => Enum[
      'ssh-dss',
      'ssh-rsa',
      'ecdsa-sha2-nistp256',
      'ecdsa-sha2-nistp384',
      'ecdsa-sha2-nistp521',
      'ssh-ed25519',
    ],
    'tag'          => Optional[
      Enum[
        'ssh-dss',
        'ssh-rsa',
        'ecdsa-sha2-nistp256',
        'ecdsa-sha2-nistp384',
        'ecdsa-sha2-nistp521',
        'ssh-ed25519',
      ]
    ],
    'key'          => String,
    'ensure'       => Optional[Enum['present','absent']],
    'marker'       => Optional[Enum['cert-authority','revoked']],
  }]]`

ssh public keys to place in known hosts file, similar in structure to sshkey resource but supports markers

##### `supported_key_types`

Data type: `Array[Enum[
    'rsa',
    'dsa',
    'ecdsa',
    'ed25519',
  ]]`

list of key types supported (or desired) for host keys and known hosts

##### `service`

Data type: `String`

name of the service to start, enable, etc.

##### `packages`

Data type: `Optional[Array[String]]`

list of packages to install for the openssh server and client

##### `service_ensure`

Data type: `Variant[Enum['running','stopped'],Undef]`

running, stopped or undefined

Default value: `'running'`

##### `service_enable`

Data type: `Variant[Boolean,Undef]`

enable the service or not

Default value: ``true``

##### `type_to_type`

Data type: `Hash[String,String]`

map used to turn full ssh key types into short names (ssh-rsa => rsa)

### `openssh::authorized_keys`

calls create_rsources on the ssh_authorized_keys hash

### `openssh::config`

configure openssh, install ssh keys, etc.

### `openssh::install`

install packages as needed

### `openssh::known_hosts`

use a template to create a non-hashed known hosts file
use a shell script to create a hashed version

### `openssh::service`

control the openssh service

### `openssh::ssh_config`

create ssh_config resources

## Defined types

### `openssh::keypair`

installs ssh host key pairs onto a system, possibly include a cert

#### Examples

##### 

```puppet
openssh::keypair { 'my rsa key':
  keytype => 'rsa',
  private_key => $some_key,
  public_key => 'ssh-rsa ...',
}
```

#### Parameters

The following parameters are available in the `openssh::keypair` defined type.

##### `keytype`

Data type: `Enum['rsa1','rsa','dsa','ecdsa','ed25519']`

ssh key type, rsa, ecdsa, etc.

##### `private_key`

Data type: `Variant[String,Undef]`

private key as a string for the given keytype
do not store this in puppet without encryption, or use some other form of secret injection

##### `public_key`

Data type: `Variant[String,Undef]`

public key as a string, with or without the leading keytype and trailing comment

##### `public_cert`

Data type: `Variant[String,Undef]`

complete public cert, a signed version of the matching public key

Default value: ``undef``

##### `mode`

Data type: `Stdlib::Filemode`

mode to create the private key with, defaults to private_key_mode from module

Default value: `$::openssh::private_key_mode`

##### `group`

Data type: `Variant[String,Integer]`

group to use on the private key, defaults to private_key_group from module

Default value: `$::openssh::private_key_group`

##### `owner`

Data type: `Variant[String,Integer]`

owner of the private key file, defaults to private_key_owner

Default value: `$::openssh::private_key_owner`

##### `ssh_etc`

Data type: `Stdlib::Absolutepath`

directory to put keys in, defaults to module default (/etc/ssh, most likely)

Default value: `$::openssh::ssh_etc`

